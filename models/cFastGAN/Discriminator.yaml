#FastGAN Discriminator
#[input, name, args]
discriminator:
  [#head
   [null, nn.Conv2d, [3, 64, 3, 1, 1]],
   [-1, nn.LeakyReLU, [0.1]],
   [-1, nn.Conv2d, [64, 64, 3, 1, 1]],
   [-1, nn.BatchNorm2d, [64]],
   [-1, nn.LeakyReLU, [0.1]],
   #backbone
   [-1, ResBlock, [64, 128]],
   [-1, ResBlock, [128, 256]],
   [-1, ResBlock, [256, 512]], #f1, 7
   [-1, ResBlock, [512, 512]], #f2, 8
   #tail
   [-1, nn.Conv2d, [512, 256, 1, 1, 0]],
   [-1, nn.BatchNorm2d, [256]],
   [-1, nn.LeakyReLU, [0.1]],
   [-1, nn.Conv2d, [256, 256, 4, 1, 0]],
   [-1, nn.AdaptiveAvgPool2d, [[1, 1]]],
   [-1, nn.Flatten, [1, -1]],
   [-1, nn.LeakyReLU, [0.1]],
   [-1, nn.Linear, [256, 1]] #16
  ]

decoder_0:
  [
   [[7, null], Crop, [0.5]], #17
   [[[-1, 0]], Decoder, [512, 3]], #18
   [[-1, [17, 1]], Stack] #19
  ]

decoder_1:
  [
   [8, Decoder, [512, 3]], #20
   [null, transforms.Resize, [[64, 64]]], #21
   [[20, -1], Stack] #22
  ]

gather:
  [
   [[16, 19, 22], Gather]
  ]
