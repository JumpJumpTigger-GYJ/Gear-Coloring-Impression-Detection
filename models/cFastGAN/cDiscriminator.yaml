#FastGAN Discriminator

 #[input, name, args]
discriminator:
  [#head
   [[[null, 1]], Reshape, [-1, 7, 1, 1]],
   [-1, ConvTranspose, [7, 8]],
   [-1, BasicBlock, [8, 16, True]],
   [-1, BasicBlock, [16, 32, True]],
   [-1, BasicBlock, [32, 64, True]], #4
   [[[null, 0]], nn.Conv2d, [3, 64, 3, 1, 1]],
   [-1, nn.LeakyReLU, [0.1]],
   [-1, nn.Conv2d, [64, 64, 3, 1, 1]],
   [-1, nn.BatchNorm2d, [64]],
   [-1, nn.LeakyReLU, [0.1]],
   #backbone
   [-1, ResBlock, [64, 128]],
   [-1, ResBlock, [128, 256]],
   [[-1, 4], Concat, [320, 256]],
   [-1, ResBlock, [256, 512]], #f1, 13
   [-1, ResBlock, [512, 512]], #f2, 14
   #tail
   [-1, nn.Conv2d, [512, 256, 1, 1, 0]],
   [-1, nn.BatchNorm2d, [256]],
   [-1, nn.LeakyReLU, [0.1]],
   [-1, nn.Conv2d, [256, 256, 4, 1, 0]],
   [-1, nn.AdaptiveAvgPool2d, [[1, 1]]],
   [-1, nn.Flatten, [1, -1]], #20
   [-1, nn.LeakyReLU, [0.1]],
   [-1, nn.Linear, [256, 1]] #22
  ]

classifier:
  [
   [20, nn.Linear, [256, 128]],
   [-1, nn.LeakyReLU, [0.1]],
   [-1, nn.Linear, [128, 7]] #25
  ]

decoder_0:
  [[[13, [null, 0]], Crop, [0.5]], #26
   [[[-1, 0]], Decoder, [512, 3]], #27
   [[-1, [26, 1]], Stack] #28
  ]

decoder_1:
  [[14, Decoder, [512, 3]], #29
   [[[null, 0]], transforms.Resize, [[64, 64]]], #30
   [[29, -1], Stack] #31
  ]

gather:
  [
   [[22, 25, 28, 31], Gather]
  ]
