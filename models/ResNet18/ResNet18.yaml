resnet:
  [
   [null, nn.Conv2d, [3, 64, 3, 2, 1]],
   [-1, nn.BatchNorm2d, [64]],
   [-1, ResBlk, [64, 64, 2]],
   [-1, ResBlk, [64, 64, 1]],
   [-1, ResBlk, [64, 128, 2]],
   [-1, ResBlk, [128, 128, 1]],
   [-1, ResBlk, [128, 256, 2]],
   [-1, ResBlk, [256, 256, 1]],
   [-1, ResBlk, [256, 512, 2]],
   [-1, ResBlk, [512, 512, 1]],
   [-1, nn.AdaptiveAvgPool2d, [[1, 1]]],
   [-1, nn.Flatten],
   [-1, nn.Linear, [512, 128]], #12
   [-1, nn.Tanh],
   [-1, nn.Linear, [128, 2]] #14
  ]

classifier:
  [
   [-1, nn.Linear, [2, 128]],
   [-1, nn.Tanh], #16
   [-1, nn.Linear, [128, 7]] #17
  ]

gather:
  [
   [[12, 16], Stack], #18
   [[17, -1, 14], Gather]
  ]